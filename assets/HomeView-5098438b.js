import{r as z,a as O,w as J,o as q,b as K,c as N,d as C,e as r,f as x,g as S,t as B,n as L,h as Q,i as Y}from"./index-f86b2b91.js";var j=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Z(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ee(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var A=ee,te=typeof j=="object"&&j&&j.Object===Object&&j,ne=te,re=ne,ae=typeof self=="object"&&self&&self.Object===Object&&self,oe=re||ae||Function("return this")(),R=oe,se=R,ie=function(){return se.Date.now()},le=ie,ce=/\s/;function ue(e){for(var t=e.length;t--&&ce.test(e.charAt(t)););return t}var de=ue,fe=de,me=/^\s+/;function be(e){return e&&e.slice(0,fe(e)+1).replace(me,"")}var ve=be,ge=R,pe=ge.Symbol,V=pe,F=V,U=Object.prototype,_e=U.hasOwnProperty,he=U.toString,h=F?F.toStringTag:void 0;function ye(e){var t=_e.call(e,h),n=e[h];try{e[h]=void 0;var o=!0}catch{}var l=he.call(e);return o&&(t?e[h]=n:delete e[h]),l}var Te=ye,xe=Object.prototype,Se=xe.toString;function je(e){return Se.call(e)}var we=je,P=V,Oe=Te,$e=we,Ne="[object Null]",Ee="[object Undefined]",D=P?P.toStringTag:void 0;function Ie(e){return e==null?e===void 0?Ee:Ne:D&&D in Object(e)?Oe(e):$e(e)}var ke=Ie;function Ce(e){return e!=null&&typeof e=="object"}var Be=Ce,Le=ke,Fe=Be,Pe="[object Symbol]";function De(e){return typeof e=="symbol"||Fe(e)&&Le(e)==Pe}var Ge=De,Me=ve,G=A,We=Ge,M=0/0,Ae=/^[-+]0x[0-9a-f]+$/i,Re=/^0b[01]+$/i,Ve=/^0o[0-7]+$/i,Ue=parseInt;function He(e){if(typeof e=="number")return e;if(We(e))return M;if(G(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=G(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Me(e);var n=Re.test(e);return n||Ve.test(e)?Ue(e.slice(2),n?2:8):Ae.test(e)?M:+e}var Xe=He,ze=A,$=le,W=Xe,Je="Expected a function",qe=Math.max,Ke=Math.min;function Qe(e,t,n){var o,l,c,d,s,u,f=0,y=!1,b=!1,v=!0;if(typeof e!="function")throw new TypeError(Je);t=W(t)||0,ze(n)&&(y=!!n.leading,b="maxWait"in n,c=b?qe(W(n.maxWait)||0,t):c,v="trailing"in n?!!n.trailing:v);function i(a){var m=o,_=l;return o=l=void 0,f=a,d=e.apply(_,m),d}function g(a){return f=a,s=setTimeout(T,t),y?i(a):d}function p(a){var m=a-u,_=a-f,k=t-m;return b?Ke(k,c-_):k}function E(a){var m=a-u,_=a-f;return u===void 0||m>=t||m<0||b&&_>=c}function T(){var a=$();if(E(a))return I(a);s=setTimeout(T,p(a))}function I(a){return s=void 0,v&&o?i(a):(o=l=void 0,d)}function H(){s!==void 0&&clearTimeout(s),f=0,o=u=l=s=void 0}function X(){return s===void 0?d:I($())}function w(){var a=$(),m=E(a);if(o=arguments,l=this,u=a,m){if(s===void 0)return g(u);if(b)return clearTimeout(s),s=setTimeout(T,t),i(u)}return s===void 0&&(s=setTimeout(T,t)),d}return w.cancel=H,w.flush=X,w}var Ye=Qe;const Ze=Z(Ye),et={class:"position-absolute-center text-cen"},tt=r("ol",{class:"text-18 text-gray mb-5"},[r("li",null,"表單輸入文字後 1秒內未操作, 就會自動儲存"),r("li",null,"此處模擬 AJAX 非同步3秒後才儲存完畢, 並顯示儲存成功提示"),r("li",null,"若在儲存完畢前離開、重整頁面, 就會彈窗提示用戶表單尚未儲存好")],-1),nt={for:"name",class:"form-label text-18 text-gray"},rt={type:"text",class:"form-control mb-2",id:"name",placeholder:"請輸入姓名"},at={for:"email",class:"form-label text-18 text-gray"},ot={type:"email",class:"form-control mb-2",id:"email",placeholder:"請輸入信箱"},st={for:"phone",class:"form-label text-18 text-gray"},it={type:"phone",class:"form-control mb-2",id:"phone",maxlength:"10",placeholder:"請輸入手機"},lt={for:"id",class:"form-label text-18 text-gray"},ct={type:"text",class:"form-control mb-2",id:"id",maxlength:"10",placeholder:"請輸入身分證"},ut={class:"mt-10"},dt={key:0,class:"position-absolute d-flex align-items-center"},ft=r("span",{class:"visually-hidden"},"Loading...",-1),mt=[ft],bt={__name:"Form",setup(e,{expose:t}){const n=z({name:"",id:"",email:"",phone:""}),o=O({isShow:!1,message:"自動儲存中...",className:"text-gray",spinnerClassName:"text-secondary"}),l=O(!1),c=O(!1),d=Ze(s,1e3);J(n,()=>{l.value&&(c.value=!1,y(),d())},{deep:!0}),q(()=>{setTimeout(()=>{l.value=!0},1e3)}),t({form:n});async function s(){console.log("此處 call api 儲存表單",n),v("loading"),await u(),console.log("儲存完畢"),b(),v("success"),setTimeout(()=>{v("loading"),o.value.isShow=!1,c.value=!1},1e3)}function u(){return new Promise((i,g)=>{setTimeout(()=>{i()},3e3)})}function f(i){return c.value?"":(i.preventDefault(),i.returnValue="","您的表單尚未儲存，確定要離開嗎？")}function y(){window.onbeforeunload||window.addEventListener("beforeunload",f)}function b(){window.removeEventListener("beforeunload",f)}function v(i){const g={loading:{isShow:!0,message:"自動儲存中...",className:"text-gray",spinnerClassName:"text-secondary"},success:{isShow:!0,message:"自動儲存成功",className:"text-success",spinnerClassName:"text-success"}};o.value=g[i]}return(i,g)=>{const p=K("model-save");return N(),C("form",et,[tt,r("div",null,[r("label",nt,[x(" 姓名 "),S(r("input",rt,null,512),[[p,n.name]])])]),r("div",null,[r("label",at,[x(" 信箱 "),S(r("input",ot,null,512),[[p,n.email]])])]),r("div",null,[r("label",st,[x(" 手機 "),S(r("input",it,null,512),[[p,n.phone]])])]),r("div",null,[r("label",lt,[x(" 身分證 "),S(r("input",ct,null,512),[[p,n.id]])])]),r("pre",ut,[r("code",null,B(n),1)]),o.value.isShow?(N(),C("div",dt,[r("div",{class:L(["spinner-border text-20",o.value.spinnerClassName]),role:"status"},mt,2),r("span",{class:L(["text-20 text-gray fw-bold-7 ms-5",o.value.className])},B(o.value.message),3)])):Q("",!0)])}}},gt={__name:"HomeView",setup(e){return(t,n)=>(N(),Y(bt))}};export{gt as default};
